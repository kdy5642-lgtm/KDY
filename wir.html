<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>대공 PKG3 WIR 현황</title>

<style>
    * { box-sizing: border-box; }
    body {
        margin: 0;
        background: #f5f6fa;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
    }

    .container {
        max-width: 1100px;
        margin: 0 auto;
        padding: 0 10px 40px;
    }

    /* 상단 제목 */
    .top-title {
        font-size: 26px;
        font-weight: 700;
        padding: 16px 4px 8px;
    }

    /* 검색 + 뒤로가기 바 */
    .search-bar-wrap {
        position: sticky;
        top: 0;
        background: #f5f6fa;
        padding: 8px 0 10px;
        z-index: 999;
    }
    .search-row {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    /* 검색창 */
    .search-input {
        flex: 1;
        padding: 10px 14px;
        font-size: 15px;
        border: 1px solid #ccc;
        border-radius: 8px;
        outline: none;
    }

    /* 뒤로가기 버튼 */
    .back-btn {
        background: #2563eb;
        border: none;
        padding: 10px 16px;
        font-size: 15px;
        color: white;
        border-radius: 8px;
        cursor: pointer;
    }

    /* 테이블 전체 영역 */
    .table-wrapper {
        margin-top: 6px;
    }

    /* 엑셀 틀고정: 헤더 고정 */
    .table-header {
        position: sticky;
        top: 62px;
        z-index: 900;
        background: white;
        border-bottom: 2px solid #ddd;
        font-weight: bold;
    }

    /* NOTE 컬럼 포함한 전체 grid 구조 */
    .table-row {
        display: grid;
        grid-template-columns:
            80px       /* INDEX */
            360px      /* ISO */
            70px       /* Joint */
            120px      /* W/D No */
            120px      /* Date */
            1fr;       /* NOTE (남는 여백 전부 먹음) */
        padding: 4px 8px;
        border-bottom: 1px solid #eee;
        background: white;
        align-items: center;
        font-size: 15px;
    }

    /* 홀짝 줄 구분 */
    .table-row:nth-child(even) {
        background: #fafafa;
    }

    /* ISO 가운데 정렬 */
    .iso-cell {
        text-align: center;
    }

    /* NOTE 칸 */
    .note-cell {
        color: #999;
        padding-left: 8px;
    }

    /* 행 하이라이트 */
    .table-row:hover {
        background: #eaf1ff;
        transition: 0.15s;
    }

    /* 로딩 오버레이 */
    #loading-overlay {
        position: fixed;
        inset: 0;
        background: rgba(255,255,255,0.75);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 3000;
        font-size: 22px;
        font-weight: 600;
        display: none;
    }

</style>
</head>
<body>

<div id="loading-overlay">⏳ 로딩 중...</div>

<div class="container">

    <div class="top-title">대공 PKG3 WIR 현황</div>

    <!-- 검색바 고정 -->
    <div class="search-bar-wrap">
        <div class="search-row">
            <input id="searchInput" class="search-input" placeholder="예: 0001, 00701, DK-GW-048, 20250113 등" />
            <button class="back-btn" onclick="history.back()">뒤로가기</button>
        </div>
    </div>

    <!-- 테이블 -->
    <div class="table-wrapper">

        <!-- 헤더 고정 -->
        <div class="table-header table-row">
            <div>INDEX</div>
            <div>ISO 도면번호</div>
            <div>Joint</div>
            <div>W/D No</div>
            <div>Date</div>
            <div>Note</div>
        </div>

        <!-- 데이터 들어가는 곳 -->
        <div id="tableBody"></div>

    </div>
</div>

<script>
let wirData = [];

async function loadData() {
    showLoading(true);
    const response = await fetch("wirdata.txt");
    const text = await response.text();

    const lines = text.trim().split("\n");
    wirData = lines.map(line => {
        const parts = line.split("\t");
        return {
            index: parts[0] || "",
            iso: parts[1] || "",
            joint: parts[2] || "",
            wd: parts[3] || "",
            date: parts[4] || ""
        };
    });

    showLoading(false);
    renderTable(wirData);
}

function renderTable(list) {
    const body = document.getElementById("tableBody");
    body.innerHTML = "";

    list.forEach(row => {
        const div = document.createElement("div");
        div.className = "table-row";
        div.innerHTML = `
            <div>${row.index}</div>
            <div class="iso-cell">${row.iso}</div>
            <div>${row.joint}</div>
            <div>${row.wd}</div>
            <div>${row.date}</div>
            <div class="note-cell"></div>
        `;
        body.appendChild(div);
    });
}

function showLoading(show) {
    document.getElementById("loading-overlay").style.display = show ? "flex" : "none";
}

/* 통합검색 */
document.getElementById("searchInput").addEventListener("input", function () {
    const q = this.value.trim().toLowerCase();

    if (q === "") {
        renderTable(wirData);
        return;
    }

    showLoading(true);

    setTimeout(() => {
        const filtered = wirData.filter(r =>
            r.index.toLowerCase().includes(q) ||
            r.iso.toLowerCase().includes(q) ||
            r.joint.toLowerCase().includes(q) ||
            r.wd.toLowerCase().includes(q) ||
            r.date.toLowerCase().includes(q)
        );

        renderTable(filtered);
        showLoading(false);
    }, 200);
});

loadData();
</script>

</body>
</html>
